# Dunst notification status for eww (event-driven via D-Bus)
# Returns: JSON with paused state and waiting count
# Example: {"paused": false, "waiting": 0}

get_status() {
  paused=$(dunstctl is-paused)
  waiting=$(dunstctl count waiting 2>/dev/null || echo 0)
  echo "{\"paused\": $paused, \"waiting\": $waiting}"
}

# Initial status
get_status

# Monitor D-Bus for dunst property changes
dbus-monitor --session "interface='org.freedesktop.DBus.Properties',member='PropertiesChanged',path='/org/freedesktop/Notifications'" 2>/dev/null |
  while read -r _; do
    get_status
  done
